@{
    ViewData["Title"] = "Submit Claim";
}

<div class="form-container">
    <h2 class="mb-4">Submit Monthly Claim</h2>

    @if (ViewBag.Error != null)
    {
        <p class="error">@ViewBag.Error</p>
    }
    @if (ViewBag.Message != null)
    {
        <p class="success">@ViewBag.Message</p>
    }

    <form method="post" enctype="multipart/form-data" onsubmit="return validateForm()">
        <div class="mb-3">
            <label class="form-label">Hours Worked</label>
            <input type="number" step="0.01" id="hours" name="HoursWorked" class="form-control" required />
        </div>

        <div class="mb-3">
            <label class="form-label">Hourly Rate</label>
            <input type="number" step="0.01" id="rate" name="HourlyRate" class="form-control" required />
        </div>

        <div class="mb-3">
            <label class="form-label">Total Amount (Auto-Calculated)</label>
            <input type="number" step="0.01" id="total" class="form-control" readonly />
        </div>

        <div class="mb-3">
            <label class="form-label">Notes</label>
            <textarea name="Notes" class="form-control"></textarea>
        </div>

        <div class="mb-3">
            <label class="form-label">Upload Supporting Document (.pdf, .docx, .xlsx)</label>
            <input type="file" name="file" class="form-control" />
        </div>

        <button type="submit" class="btn btn-primary w-100">Submit Claim</button>
    </form>

    <div class="mt-3">
        <a href="/Lecturer/Index" class="btn btn-outline-secondary w-100">⬅ Back to Dashboard</a>
    </div>

</div>

<script>
    function updateTotal() {
        let h = parseFloat(document.getElementById("hours").value) || 0;
        let r = parseFloat(document.getElementById("rate").value) || 0;
        document.getElementById("total").value = (h * r).toFixed(2);
    }

    document.getElementById("hours").addEventListener("input", updateTotal);
    document.getElementById("rate").addEventListener("input", updateTotal);

    function validateForm() {
        let h = parseFloat(document.getElementById("hours").value);
        let r = parseFloat(document.getElementById("rate").value);

        if (h <= 0) { alert("Hours worked must be greater than zero."); return false; }
        if (r <= 0) { alert("Hourly rate must be greater than zero."); return false; }
        if (h > 300) { alert("Hours cannot exceed 300 per month."); return false; }

        return true;
    }
</script>
